### sqlmap

sqlmap is an open-source penetration testing tool that automates the process of detecting and exploiting SQL injection flaws and taking over database servers. **When to use it:**

- To automatically scan a web application for SQL injection vulnerabilities.
- To exploit a confirmed SQL injection flaw to enumerate databases, tables, columns, and data.
- To dump entire database tables or retrieve specific files.
- To attempt to escalate privileges on the database server to an operating system shell. **Quick usage (learning):**

bash

```
# Scan a specific URL for SQL injection vulnerabilities
sqlmap -u "http://<TARGET_IP>/test.php?id=1"

# If an injection is found, list the databases
sqlmap -u "http://<TARGET_IP>/test.php?id=1" --dbs

# Dump all data from a specific table
sqlmap -u "http://<TARGET_IP>/test.php?id=1" -D <database_name> -T <table_name> --dump
```

**Common flags / options:**

- `-u <url>`: Target URL.
- `--dbs`: Enumerate databases.
- `-D <db>`: Specify a database to use.
- `-T <table>`: Specify a table to use.
- `--dump`: Dump table entries.
- `--os-shell`: Attempt to get an interactive OS shell.
- `--batch`: Never ask for user input, use default behaviors. **Authorized commands (AUTHORIZED‑ONLY):** Advanced actionable guidance requires proof of authorization. **Defensive/detection notes:**
- A WAF is the primary defense, with signatures to detect common SQL injection payloads used by sqlmap (e.g., `UNION SELECT`, `SLEEP()`).
- Use parameterized queries (prepared statements) in web application code to prevent SQL injection entirely.
- Monitor database logs for suspicious or malformed queries. **Recommended lab exercise:** Set up OWASP Juice Shop or DVWA (Damn Vulnerable Web Application). Find a page vulnerable to SQL injection and use `sqlmap` to enumerate the backend database and extract user credentials. **Further reading / official docs:**
- sqlmap Official Website: `http://sqlmap.org/`
- GitHub Repository: `https://github.com/sqlmapproject/sqlmap`