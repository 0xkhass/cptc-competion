### Nmap

Network Mapper (Nmap) is a powerful, free, and open-source utility for network discovery, port scanning, and security auditing. **When to use it:**

- To discover live hosts on a network (host discovery).
- To identify open TCP/UDP ports on a target system (port scanning).
- To determine the services and their versions running on open ports (service/version detection).
- To gather information about the target's operating system (OS fingerprinting). **Quick usage (learning):**

bash

```
# Perform a fast scan on the most common 1,000 TCP ports
nmap <TARGET_IP>

# Perform a comprehensive scan: TCP SYN scan (-sS), service version detection (-sV), OS detection (-O), and default script scanning (-sC)
nmap -sS -sV -sC -O <TARGET_IP>

# A more aggressive, all-in-one scan (equivalent to the above + traceroute)
nmap -A <TARGET_IP>
```

**Common flags / options:**

- `-sS`: TCP SYN "stealth" scan (less likely to be logged).
- `-sU`: UDP scan.
- `-p-`: Scan all 65,535 TCP ports.
- `-sV`: Probe open ports to determine service/version info.
- `-O`: Enable operating system detection.
- `-n`: Disable DNS resolution (faster).
- `-T<0-5>`: Set timing template (T4 is aggressive, T5 is insane). **Authorized commands (AUTHORIZED‑ONLY):** Advanced actionable guidance requires proof of authorization. **Defensive/detection notes:**
- Intrusion Detection/Prevention Systems (IDS/IPS) have signatures to detect and alert on or block Nmap scan patterns.
- Firewall logs can show a large number of connections or connection attempts from a single source to many ports.
- Port knocking can be used to hide services from basic port scans. **Recommended lab exercise:** Deploy a Metasploitable 2 virtual machine on the same network as your Kali machine. Use Nmap to scan the Metasploitable VM to discover its open ports and running services. **Further reading / official docs:**
- Nmap Official Website: `https://nmap.org`
- Nmap Reference Guide: `https://nmap.org/book/man.html`