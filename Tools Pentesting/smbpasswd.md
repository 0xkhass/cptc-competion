`smbpasswd` is a command-line utility for changing a user's SMB/CIFS password on a Samba server or a Windows machine. **When to use it:**

- Legitimately, to change your own password on a remote Samba server.
- As an attacker, to change the password of a compromised user account if you have their current password.
- To create or modify the local Samba user database (`smbpasswd` file). **Quick usage (learning):**

bash

```
# Change a user's password on a remote server (you will be prompted for the old and new passwords)
smbpasswd -r <TARGET_IP> -U <USERNAME>
```

**Common flags / options:**

- `-r <hostname>`: Specify the remote machine.
- `-U <username>`: Specify the username to change the password for.
- `-a`: Add a new user to the local Samba database.
- `-d`: Disable a user account.
- `-e`: Enable a user account. **Authorized commands (AUTHORIZED‑ONLY):** Advanced actionable guidance requires proof of authorization. **Defensive/detection notes:**
- Monitor for password change events on endpoints and servers (Event ID 4724 on Windows). Correlate these with help desk tickets or expected user activity.
- Restrict the ability to change passwords remotely to specific administrative groups.
- Enforce strong password history and complexity requirements to prevent trivial password changes. **Recommended lab exercise:** Set up a basic Samba server on a Linux VM. Create a user and use `smbpasswd` from your Kali machine to change that user's password. **Further reading / official docs:**
- Samba Official Documentation: `https://www.samba.org/samba/docs/`
- `smbpasswd` man page: `man smbpasswd`