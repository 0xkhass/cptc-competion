### WinRM

Windows Remote Management (WinRM) is the Microsoft implementation of the WS-Management Protocol, allowing administrators to manage Windows servers remotely. **When to use it:**

- As a legitimate administrative tool for executing commands and scripts on remote Windows systems.
- As an attacker, for lateral movement and remote execution on hosts where you have credentials and WinRM is enabled (Port 5985/HTTP, 5986/HTTPS).
- As an alternative to SMB/RPC-based tools like `psexec` for remote control.
- To interact with PowerShell remoting capabilities. **Quick usage (learning):** From a Linux machine with `evil-winrm` installed:

bash

```
# Connect to a target using WinRM with a username and password
evil-winrm -i <TARGET_IP> -u '<USERNAME>' -p '<PASSWORD>'
```

From a Windows machine using PowerShell:

PowerShell

```
# Enter a remote PowerShell session
Enter-PSSession -ComputerName <TARGET_IP> -Credential (Get-Credential)

# Invoke a command on a remote machine
Invoke-Command -ComputerName <TARGET_IP> -ScriptBlock { whoami }
```

**Common flags / options:**

- **evil-winrm:**
    - `-i`: Target IP address.
    - `-u`: Username.
    - `-p`: Password.
    - `-H`: Authenticate with NTLM hash.
    - `-S`: Use SSL (connects to port 5986). **Authorized commands (AUTHORIZED‑ONLY):** Advanced actionable guidance requires proof of authorization. **Defensive/detection notes:**
- Monitor WinRM logs (Windows Remote Management/Operational event log) for suspicious connections or command execution.
- Enable PowerShell Script Block Logging and Transcription to capture all commands executed via WinRM sessions.
- Restrict WinRM access via host-based firewalls to only allow connections from trusted management servers. **Recommended lab exercise:** Enable WinRM on a Windows 10/11 VM (`Enable-PSRemoting -Force`). From your Kali machine, use `evil-winrm` to connect to it and practice uploading/downloading files and executing basic commands. **Further reading / official docs:**
- Microsoft WinRM Documentation: `https://docs.microsoft.com/en-us/windows/win32/winrm/windows-remote-management`
- evil-winrm GitHub: `https://github.com/Hackplayers/evil-winrm`