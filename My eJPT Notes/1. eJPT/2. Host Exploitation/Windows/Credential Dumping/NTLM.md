#### **Good resource: https://systemweakness.com/difference-between-nt-lm-ntlm-net-ntlmv1-v2-ntlmv1-v2-hashes-c6df0afde008**

The Windows OS stores hashed user account passwords locally in the **<mark style="background: #0b5345;">SAM (Security Accounts Manager) database</mark>**.
This can be done by copying the SAM and SYSTEM registry hives from a system.

Authentication and verification of user credentials is facilitated by the **Local Security Authority (LSA) or LSASS.**

---
### ● Windows versions up to Windows Server 2003 utilize two different types of hashes :  

- ### ** "LM" Hash:** 
  Format example: `299BD128C1101FD6`, Converts the user's password to uppercase
  The older, extremely weak algorithm, extremely vulnerable to brute force attacks. Uses DES algo "<mark style="background: #e74c3c;">VERY WEAK & 100% Crackable</mark>"

![[Pasted image 20250412005337.png | 700]]
<br>
- ### ** "NTLM" or (NT) Hash:**
  Format example: `B4B9B02E6F09A9BD760F388B67351E2B`


		  The newer algorithm (also called NT hash), Uses MD4 hash, Not case-insensitive like LM and also  NTLM not slated which make them vulnerable to rainbow tables attack..

<br>
<br>

- Windows disables LM hashing and utilizes NTLM hashing from Windows Vista onwards.
<br>
- In modern Windows systems, when you see "NTLM hash," it typically refers to both components stored in the format: `LM hash:NT hash`
<br>

-  In modern versions of Windows, the SAM database is encrypted with a syskey.  
Note: Elevated/Administrative privileges are required in order to access and interact with the LSASS process.

## **<mark style="background: #e74c3c;">● NTLM</mark>**

When a user account is created, it is encrypted using the MD4 hashing algorithm, while the original password is disposed of.  
 

● **NTLM** improves upon **LM** in the following ways:  
+ Does not split the hash in to two chunks.  
+ Case sensitive.  
+ Allows the use of symbols and unicode characters.
### **<mark style="background: #FF5582A6;">But it's still vulnerable to Pass-the-Hash Attacks</mark>**



# **Crack NTLM hashes:**

if collected via meterpreter the format is like this and doesn't need to be formatted other way:

	Administrator:500:aad3b435b51404eeaad3b435b51404ee:8846f7eaee8fb117ad06bdd830b7586c:::
	bob:1009:aad3b435b51404eeaad3b435b51404ee:5835048ce94ad0564e29a924a03510ef:::
	Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::


### **John the ripper**

